{% extends "base.html" %}

{% block title %}Jobs{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Job Queue</h1>
    <form action="/clear-jobs" method="post" style="margin-bottom: 20px;">
        <button type="submit" class="btn btn-danger">ðŸ§¹ Clear Completed</button>
    </form>
</div>

<table class="table table-striped">
    <tr>
        <th>ID</th>
        <th>Surah Number</th>
        <th>Surah Name</th>
        <th>Reciter</th>
        <th>Status</th>
        <th>Progress</th>
        <th>Retries</th>
        <th>Created</th>
        <th>Actions</th>
    </tr>
    {% for job in jobs %}
    <tr>
        <td>{{ job.id }}</td>
        <td>{{ job.surah_number }}</td>
        <td>{{ job.surah_name }}</td>
        <td>{{ job.reciter }}</td>
        <td>{{ job.status }}</td>
        <td>{{ job.progress }}%</td>
        <td>{{ job.retry_count }}/{{ job.max_retries }}</td>
        <td>{{ job.created_at }}</td>
        <td>
            <form method="post" action="/delete-job/{{ job.id }}" style="display:inline;">
                <button type="submit" title="Delete" class="btn btn-outline-danger">
                    <i class="fas fa-trash"></i>
                </button>
            </form>
            <form method="post" action="/retry-job/{{ job.id }}" style="display:inline;">
                <button type="submit" title="Retry" class="btn btn-outline-warning">
                    <i class="fas fa-redo"></i>
                </button>
            </form>
        </td>
    </tr>
    {% endfor %}
</table>

{% endblock %}